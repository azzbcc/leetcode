// ä½ æ­£åœ¨å‚ä¸ç¥–ç›æ¸¸æˆçš„ä¸€ä¸ªå˜ç§ã€‚
//
// åœ¨è¿™ä¸ªç¥–ç›æ¸¸æˆå˜ä½“ä¸­ï¼Œæ¡Œé¢ä¸Šæœ‰ ä¸€æ’ å½©çƒï¼Œæ¯ä¸ªçƒçš„é¢œè‰²å¯èƒ½æ˜¯ï¼šçº¢è‰² 'R'ã€é»„è‰² 'Y'ã€è“è‰² 'B'ã€ç»¿è‰² 'G' æˆ–ç™½è‰² 'W'
// ã€‚ä½ çš„æ‰‹ä¸­ä¹Ÿæœ‰ä¸€äº›å½©çƒã€‚
//
// ä½ çš„ç›®æ ‡æ˜¯ æ¸…ç©º æ¡Œé¢ä¸Šæ‰€æœ‰çš„çƒã€‚æ¯ä¸€å›åˆï¼š
//
//
// ä»ä½ æ‰‹ä¸Šçš„å½©çƒä¸­é€‰å‡º ä»»æ„ä¸€é¢— ï¼Œç„¶åå°†å…¶æ’å…¥æ¡Œé¢ä¸Šé‚£ä¸€æ’çƒä¸­ï¼šä¸¤çƒä¹‹é—´æˆ–è¿™ä¸€æ’çƒçš„ä»»ä¸€ç«¯ã€‚
// æ¥ç€ï¼Œå¦‚æœæœ‰å‡ºç° ä¸‰ä¸ªæˆ–è€…ä¸‰ä¸ªä»¥ä¸Š ä¸” é¢œè‰²ç›¸åŒ çš„çƒç›¸è¿çš„è¯ï¼Œå°±æŠŠå®ƒä»¬ç§»é™¤æ‰ã€‚
//
// å¦‚æœè¿™ç§ç§»é™¤æ“ä½œåŒæ ·å¯¼è‡´å‡ºç°ä¸‰ä¸ªæˆ–è€…ä¸‰ä¸ªä»¥ä¸Šä¸”é¢œè‰²ç›¸åŒçš„çƒç›¸è¿ï¼Œåˆ™å¯ä»¥ç»§ç»­ç§»é™¤è¿™äº›çƒï¼Œç›´åˆ°ä¸å†æ»¡è¶³ç§»é™¤æ¡ä»¶ã€‚
//
//
// å¦‚æœæ¡Œé¢ä¸Šæ‰€æœ‰çƒéƒ½è¢«ç§»é™¤ï¼Œåˆ™è®¤ä¸ºä½ èµ¢å¾—æœ¬åœºæ¸¸æˆã€‚
// é‡å¤è¿™ä¸ªè¿‡ç¨‹ï¼Œç›´åˆ°ä½ èµ¢äº†æ¸¸æˆæˆ–è€…æ‰‹ä¸­æ²¡æœ‰æ›´å¤šçš„çƒã€‚
//
//
// ç»™ä½ ä¸€ä¸ªå­—ç¬¦ä¸² board ï¼Œè¡¨ç¤ºæ¡Œé¢ä¸Šæœ€å¼€å§‹çš„é‚£æ’çƒã€‚å¦ç»™ä½ ä¸€ä¸ªå­—ç¬¦ä¸² hand
// ï¼Œè¡¨ç¤ºæ‰‹é‡Œçš„å½©çƒã€‚è¯·ä½ æŒ‰ä¸Šè¿°æ“ä½œæ­¥éª¤ç§»é™¤æ‰æ¡Œä¸Šæ‰€æœ‰çƒï¼Œè®¡ç®—å¹¶è¿”å›æ‰€éœ€çš„ æœ€å°‘ çƒæ•°ã€‚å¦‚æœä¸èƒ½ç§»é™¤æ¡Œä¸Šæ‰€æœ‰çš„çƒï¼Œè¿”å› -1
// ã€‚
//
//
//
// ç¤ºä¾‹ 1ï¼š
//
//
// è¾“å…¥ï¼šboard = "WRRBBW", hand = "RB"
// è¾“å‡ºï¼š-1
// è§£é‡Šï¼šæ— æ³•ç§»é™¤æ¡Œé¢ä¸Šçš„æ‰€æœ‰çƒã€‚å¯ä»¥å¾—åˆ°çš„æœ€å¥½å±€é¢æ˜¯ï¼š
// - æ’å…¥ä¸€ä¸ª 'R' ï¼Œä½¿æ¡Œé¢å˜ä¸º WRRRBBW ã€‚WRRRBBW -> WBBW
// - æ’å…¥ä¸€ä¸ª 'B' ï¼Œä½¿æ¡Œé¢å˜ä¸º WBBBW ã€‚WBBBW -> WW
// æ¡Œé¢ä¸Šè¿˜å‰©ç€çƒï¼Œæ²¡æœ‰å…¶ä»–çƒå¯ä»¥æ’å…¥ã€‚
//
// ç¤ºä¾‹ 2ï¼š
//
//
// è¾“å…¥ï¼šboard = "WWRRBBWW", hand = "WRBRW"
// è¾“å‡ºï¼š2
// è§£é‡Šï¼šè¦æƒ³æ¸…ç©ºæ¡Œé¢ä¸Šçš„çƒï¼Œå¯ä»¥æŒ‰ä¸‹è¿°æ­¥éª¤ï¼š
// - æ’å…¥ä¸€ä¸ª 'R' ï¼Œä½¿æ¡Œé¢å˜ä¸º WWRRRBBWW ã€‚WWRRRBBWW -> WWBBWW
// - æ’å…¥ä¸€ä¸ª 'B' ï¼Œä½¿æ¡Œé¢å˜ä¸º WWBBBWW ã€‚WWBBBWW -> WWWW -> empty
// åªéœ€ä»æ‰‹ä¸­å‡º 2 ä¸ªçƒå°±å¯ä»¥æ¸…ç©ºæ¡Œé¢ã€‚
//
//
// ç¤ºä¾‹ 3ï¼š
//
//
// è¾“å…¥ï¼šboard = "G", hand = "GGGGG"
// è¾“å‡ºï¼š2
// è§£é‡Šï¼šè¦æƒ³æ¸…ç©ºæ¡Œé¢ä¸Šçš„çƒï¼Œå¯ä»¥æŒ‰ä¸‹è¿°æ­¥éª¤ï¼š
// - æ’å…¥ä¸€ä¸ª 'G' ï¼Œä½¿æ¡Œé¢å˜ä¸º GG ã€‚
// - æ’å…¥ä¸€ä¸ª 'G' ï¼Œä½¿æ¡Œé¢å˜ä¸º GGG ã€‚GGG -> empty
// åªéœ€ä»æ‰‹ä¸­å‡º 2 ä¸ªçƒå°±å¯ä»¥æ¸…ç©ºæ¡Œé¢ã€‚
//
//
// ç¤ºä¾‹ 4ï¼š
//
//
// è¾“å…¥ï¼šboard = "RBYYBBRRB", hand = "YRBGB"
// è¾“å‡ºï¼š3
// è§£é‡Šï¼šè¦æƒ³æ¸…ç©ºæ¡Œé¢ä¸Šçš„çƒï¼Œå¯ä»¥æŒ‰ä¸‹è¿°æ­¥éª¤ï¼š
// - æ’å…¥ä¸€ä¸ª 'Y' ï¼Œä½¿æ¡Œé¢å˜ä¸º RBYYYBBRRB ã€‚RBYYYBBRRB -> RBBBRRB -> RRRB -> B
// - æ’å…¥ä¸€ä¸ª 'B' ï¼Œä½¿æ¡Œé¢å˜ä¸º BB ã€‚
// - æ’å…¥ä¸€ä¸ª 'B' ï¼Œä½¿æ¡Œé¢å˜ä¸º BBB ã€‚BBB -> empty
// åªéœ€ä»æ‰‹ä¸­å‡º 3 ä¸ªçƒå°±å¯ä»¥æ¸…ç©ºæ¡Œé¢ã€‚
//
//
//
//
// æç¤ºï¼š
//
//
// 1 <= board.length <= 16
// 1 <= hand.length <= 5
// board å’Œ hand ç”±å­—ç¬¦ 'R'ã€'Y'ã€'B'ã€'G' å’Œ 'W' ç»„æˆ
// æ¡Œé¢ä¸Šä¸€å¼€å§‹çš„çƒä¸­ï¼Œä¸ä¼šæœ‰ä¸‰ä¸ªåŠä¸‰ä¸ªä»¥ä¸Šé¢œè‰²ç›¸åŒä¸”è¿ç€çš„çƒ
//
// Related Topics å­—ç¬¦ä¸² å›æº¯ ğŸ‘ 152 ğŸ‘ 0

#define MAXM 16
#define MAXN 5
typedef struct {
    int len;
    char str[MAXM + MAXN + 1];
} str_t;
static str_t mask[1] = { MAXN, "RYBGW" };
str_t str_insert(str_t *old, int pos, char ch) {
    str_t s = { sprintf(s.str, "%.*s%c%s", pos, old->str, ch, old->str + pos) };

    int l = pos, r = pos + 1, lc = 0, rc = 0;
    for (; pos >= 0; s.len -= lc + rc, pos = l, lc = rc = 0) {
        for (; l >= 0 && s.str[l] == s.str[pos]; --l, ++lc) {}
        for (; r <= old->len && s.str[r] == s.str[pos]; ++r, ++rc) {}
        if (lc + rc < 3) break;
    }
    memmove(s.str + l + lc + 1, s.str + r - rc, s.len - l - lc);

    return s;
}
void dfs(str_t *board, int hand[], int *ans, int cur) {
    if (!board->len) *ans = cur;
    if (cur >= *ans) return;
    for (int i = 0; i < mask->len; ++i) {
        if (!hand[i]) continue;
        hand[i]--;
        for (int j = 0; j < board->len; ++j) {
            if (j && board->str[j - 1] == mask->str[i]) continue;
            str_t new = str_insert(board, j, mask->str[i]);
            dfs(&new, hand, ans, cur + 1);
        }
        hand[i]++;
    }
}
int findMinStep(char *board, char *hand) {
    int ans         = INT32_MAX;
    int hands[MAXN] = { 0 };
    str_t str_board = { sprintf(str_board.str, "%s", board) };

    for (char *p = hand; *p; ++p) {
        hands[strchr(mask->str, *p) - mask->str]++;
    }
    dfs(&str_board, hands, &ans, 0);

    return ans == INT32_MAX ? -1 : ans;
}
